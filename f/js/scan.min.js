!function(t){var n=window.vm=new Vue({data:{mode:"pc",loading:!0,scanning:!1,url:"",competitionId:"",registration:{}},el:"#scan-container",ready:function(){this.competitionId=this.$el.dataset.competitionId},methods:{check:function(){this.fetchInfo(this.url),this.url=""},startScan:function(){this.scanning=!0},endScan:function(){this.scanning=!1,this.focus()},focus:function(){this.$els.urlInput.focus()},scan:function(){var t=this;t.registration={},wx.ready(function(){wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(n){var i=n.resultStr;t.fetchInfo(i)}})})},fetchInfo:function(t){var n=t.split("code=").reverse()[0];if(n){var i=n.split("-")[0],o=this;o.loading=!0,$.ajax({url:"/api/competition/"+i,data:{competition_id:o.competitionId,code:n},dataType:"json",success:function(t){0==t.status?o.registration=t.data:(alert(t.message),o.registration={})},complete:function(){o.loading=!1}})}},doAction:function(t){var n=this;n.loading=!0,$.ajax({url:"/api/competition/signin",data:{competition_id:n.competitionId,type:n.registration.type,id:n.registration.id,action:t},dataType:"json",type:"post",success:function(t){0==t.status?n.registration=t.data:alert(t.message)},complete:function(){n.loading=!1}})}},components:{}});wx.ready(function(){n.loading=!1,n.mode="wx"}),!1===/MicroMessenger/i.test(navigator.userAgent)&&(n.loading=!1,n.mode="pc",n.focus())}();